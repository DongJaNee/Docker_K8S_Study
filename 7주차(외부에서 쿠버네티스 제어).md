## Work노드에서 kubectl 동작시키기
```
cat /etc/rancher/k3s/k3s.yaml       // Master노드의 설정 파일 복사

sudo systemctl stop k3s         //work노드에서 k3s 중지
sudo mkdir /etc/rancher/k3s/          //디렉터리 생성
sudo nano /etc/rancher/k3s/k3s.yaml     //master노드에서 복사한 yaml파일 붙여넣기 ※Server: Master노드 IP주소 입력

kubectl get node          //※만약 ERROR가 발생한다면 k3삭제하고 다시 설치해서 진행
kubectl get pods

sudo sh /usr/local/bin/k3s-uninstall.sh       //k3s 삭제
curl -sfL https://get.k3s.io | sh -       //k3s 다시 설치  
```

<img width="532" height="290" alt="image" src="https://github.com/user-attachments/assets/d5fbc6e6-d1eb-4689-88f3-10b77f159fcf" />


### Master/Worker 노드 IP 주소 변경 (Master Node 기준)
```
kubectl get node -o wide
```

<img width="927" height="126" alt="image" src="https://github.com/user-attachments/assets/b89b0161-a586-4333-838a-0d892fd3b9eb" />

```
sudo nano /etc/systemd/system/k3s.service      //데몬 프로세스 k3s 설정 변경하기

ExecStart=/usr/local/bin/k3s \ server --node-ip 192.168.0.167 \

# 설정 적용 후 
sudo systemctl enable k3s
sudo systemctl restart k3s
sudo chmod +r /etc/rancher/k3s/k3s.yaml

kubectl get node -o wide     //Master노드 IP 주소 확인
```

<img width="643" height="148" alt="image" src="https://github.com/user-attachments/assets/29cc029e-ee06-4fd8-91b0-03e75675a013" />

### Master/Worker 노드 IP 주소 변경 (Worker Node 기준)
```
kubectl delete node worker      //master에서 worker node 삭제 
sudo cat /var/lib/rancher/k3s/server/node-token    //master에서 토큰 복사

sudo nano /etc/systemd/system/k3s-agent.service    //worker 기준 k3s-agent 설정 변경하기

ExecStart=/usr/local/bin/k3s \
    agent --node-ip 192.168.0.202 \
    --server https://"Master 노드 IP 주소":6443 \
    --token "Master 노드 토큰값"

sudo systemctl enable k3s-agent
sudo systemctl restart k3s-agent

kubectl get node -o wide     // 노드 ip 주소 확인
```


### Role Label 변경
```
kubectl label node sub-node node-role.kubernetes.io/worker=worker       //sub-node의 role label 변경

kubectl label node sub-node node-role.kubernetes.io/worker-        //sub-node의 role label 삭제
```


### Kubectl 명령어
```
kubectl get all       //pod, replicaset, deployment, service 조회

# node 조회 
kubectl get no
kubectl get node
kubectl get nodes

# 결과 포멧 변경
kubectl get nodes -o wide
kubectl get nodes -o yaml
kubectl get nodes -o json

# 노드 상세 정보
kubectl describe node <node name>
kubectl describe node/<node name>

# 쿠버네티스 진행상황
kubectl get events
kubectl get events -o wide | less

# pod 내부에서 명령어 실행
kubectl exec -it <pod_name> -- <command>

# pod의 컨테이너를 위한 로그
kubectl logs -f <pod_name|type/name>

# yaml파일 등을 통한 실행
kubectl apply -f <filename>

# yaml 파일 등을 통한 삭제
kubectl delete -f <filename>
```

